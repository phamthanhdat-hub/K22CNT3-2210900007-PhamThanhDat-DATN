<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tin t·ª©c | BabyCutie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/tin-tuc.css">
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="header">
    <div class="container header-wrap">
        <div class="logo" onclick="location='index.html'">
            <img src="images/logo2.jpg" alt="BabyCutie">
            <span>BabyCutie</span>
        </div>
        
        <!-- SEARCH -->
        <div class="search">
            <i class="fa fa-search" id="searchIcon" onclick="handleSearch(event)"></i>
            <input type="text" id="searchInput" placeholder="T√¨m m√≥n ƒÉn cho b√©..." onkeyup="handleSearch(event)">
        </div>
        
        <nav class="main-menu">
            <a href="index.html">Trang ch·ªß</a>
            <a href="thuc-don.html">Th·ª±c ƒë∆°n</a>
            <a href="khuyen-mai.html">Khuy·∫øn m√£i</a>
            <a href="tin-tuc.html" class="active">Tin t·ª©c</a>
            <a href="lien-he.html">Li√™n h·ªá</a>
        </nav>

        <!-- CART -->
        <div class="cart-icon" onclick="window.location='gio-hang.html'">
            <i class="fa-solid fa-cart-shopping"></i>
            <span class="cart-count" id="cartCount">0</span>
        </div>

        <!-- LOGIN / USER INFO -->
        <div class="login-group">
            <div id="userInfo" style="display: none;">
                <div class="dropdown">
                    <button class="btn-login dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fa fa-user"></i> <span id="userName"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="don-hang-cua-toi.html">üì¶ ƒê∆°n h√†ng c·ªßa t√¥i</a></li>
                        <li><a class="dropdown-item" href="#" onclick="logout()">ƒêƒÉng xu·∫•t</a></li>
                    </ul>
                </div>
            </div>
            <div id="loginBtn">
                <div class="dropdown">
                    <button class="btn-login dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fa fa-user"></i> ƒêƒÉng nh·∫≠p
                    </button>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item" href="login-khach.html">
                                üë®‚Äçüë©‚Äçüëß Kh√°ch h√†ng
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="login-admin.html">
                                üõ† Admin
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
</header>

<!-- ===== BANNER ===== -->
<section class="page-banner">
    <div class="container">
        <h1>üì∞ Tin t·ª©c dinh d∆∞·ª°ng</h1>
        <p>C·∫≠p nh·∫≠t nh·ªØng th√¥ng tin h·ªØu √≠ch v·ªÅ dinh d∆∞·ª°ng cho b√©</p>
    </div>
</section>

<!-- ===== DANH S√ÅCH TIN ===== -->
<section class="news-section">
    <div class="container">
        <div id="newsList" class="news-grid"></div>
        
        <div id="loadingNews" class="text-center py-5">
            <div class="loading"></div>
            <p class="mt-3">ƒêang t·∫£i tin t·ª©c...</p>
        </div>
        
        <div id="emptyNews" class="text-center py-5" style="display: none;">
            <i class="fa fa-newspaper"></i>
            <h3 style="color: #999; margin-top: 20px; font-weight: 700;">Ch∆∞a c√≥ tin t·ª©c n√†o</h3>
            <p class="text-muted" style="font-size: 16px; margin-top: 10px;">H√£y quay l·∫°i sau ƒë·ªÉ xem c√°c tin t·ª©c m·ªõi nh·∫•t!</p>
        </div>
    </div>
</section>

<!-- ===== FOOTER ===== -->
<footer class="footer">
    <div class="container footer-wrap">
        <div>
            <b>BabyCutie</b>
            <p>Ch√°o dinh d∆∞·ª°ng cho b√© y√™u</p>
        </div>
        <div>
            <p><strong>Li√™n k·∫øt nhanh</strong></p>
            <p>
                <a href="thuc-don.html" style="color: #666; text-decoration: none; margin-right: 15px;">Th·ª±c ƒë∆°n</a>
                <a href="khuyen-mai.html" style="color: #666; text-decoration: none; margin-right: 15px;">Khuy·∫øn m√£i</a>
                <a href="tin-tuc.html" style="color: #666; text-decoration: none; margin-right: 15px;">Tin t·ª©c</a>
                <a href="lien-he.html" style="color: #666; text-decoration: none;">Li√™n h·ªá</a>
            </p>
        </div>
        <div>
            <p><strong>Th√¥ng tin</strong></p>
            <p>
                <a href="chinh-sach-bao-mat.html" style="color: #666; text-decoration: none;">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
            </p>
            <p>üìû Hotline: 1900 1234</p>
            <p>üìß babycutie@gmail.com</p>
        </div>
    </div>
</footer>

<!-- ===== TOAST CONTAINER ===== -->
<div id="toastContainer"></div>

<!-- ===== JS RI√äNG ===== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/tin-tuc.js"></script>
<script src="js/search-common.js"></script>
<script>
// Ki·ªÉm tra ƒëƒÉng nh·∫≠p v√† hi·ªÉn th·ªã th√¥ng tin
const token = localStorage.getItem("token");
const userInfo = JSON.parse(localStorage.getItem("user_info") || '{}');

if (token && userInfo.hoTen) {
    document.getElementById("userInfo").style.display = "block";
    document.getElementById("loginBtn").style.display = "none";
    document.getElementById("userName").textContent = userInfo.hoTen;
} else {
    document.getElementById("userInfo").style.display = "none";
    document.getElementById("loginBtn").style.display = "block";
}

function logout() {
    localStorage.removeItem("token");
    localStorage.removeItem("user_info");
    if (typeof showToast === 'function') {
        showToast("ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng", "info");
    }
    setTimeout(() => {
        location.reload();
    }, 1000);
}

// C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng gi·ªè h√†ng
function updateCartCount() {
    const token = localStorage.getItem("token");
    const cartCountEl = document.getElementById("cartCount");
    
    if (!token || !cartCountEl) {
        if (cartCountEl) cartCountEl.textContent = "0";
        return;
    }
    
    fetch("http://127.0.0.1:5000/api/gio-hang", {
        headers: {"Authorization": "Bearer " + token}
    })
    .then(res => {
        if (!res.ok) throw new Error('Failed to fetch cart');
        return res.json();
    })
    .then(data => {
        const total = data.reduce((sum, item) => sum + item.soLuong, 0);
        cartCountEl.textContent = total;
        
        if (total > 0) {
            cartCountEl.style.display = "flex";
        } else {
            cartCountEl.style.display = "none";
        }
    })
    .catch(() => {
        if (cartCountEl) cartCountEl.textContent = "0";
    });
}

// C·∫≠p nh·∫≠t cart count khi load trang
if (token) {
    updateCartCount();
}
</script>

</body>
</html>
