<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tin tá»©c | BabyCutie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/tin-tuc.css">
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="header">
    <div class="container header-wrap">
        <div class="logo" onclick="location='index.html'">
            <img src="images/logo2.jpg" alt="BabyCutie">
            <span>BabyCutie</span>
        </div>
        
        <!-- SEARCH -->
        <div class="search">
            <i class="fa fa-search" id="searchIcon" onclick="handleSearch(event)"></i>
            <input type="text" id="searchInput" placeholder="TÃ¬m mÃ³n Äƒn cho bÃ©..." onkeyup="handleSearch(event)">
        </div>
        
        <nav class="main-menu">
            <a href="index.html">Trang chá»§</a>
            <a href="thuc-don.html">Thá»±c Ä‘Æ¡n</a>
            <a href="tin-tuc.html" class="active">Tin tá»©c</a>
            <a href="lien-he.html">LiÃªn há»‡</a>
        </nav>

        <!-- CART -->
        <div class="cart-icon" onclick="window.location='gio-hang.html'">
            <i class="fa-solid fa-cart-shopping"></i>
            <span class="cart-count" id="cartCount">0</span>
        </div>

        <!-- LOGIN / USER INFO -->
        <div class="login-group">
            <div id="userInfo" style="display: none;">
                <div class="dropdown">
                    <button class="btn-login dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fa fa-user"></i> <span id="userName"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="don-hang-cua-toi.html">ğŸ“¦ ÄÆ¡n hÃ ng cá»§a tÃ´i</a></li>
                        <li><a class="dropdown-item" href="#" onclick="logout()">ÄÄƒng xuáº¥t</a></li>
                    </ul>
                </div>
            </div>
            <div id="loginBtn">
                <div class="dropdown">
                    <button class="btn-login dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fa fa-user"></i> ÄÄƒng nháº­p
                    </button>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item" href="login-khach.html">
                                ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ KhÃ¡ch hÃ ng
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="login-admin.html">
                                ğŸ›  Admin
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
</header>

<!-- ===== BANNER ===== -->
<section class="page-banner">
    <div class="container">
        <h1>ğŸ“° Tin tá»©c dinh dÆ°á»¡ng</h1>
        <p>Cáº­p nháº­t nhá»¯ng thÃ´ng tin há»¯u Ã­ch vá» dinh dÆ°á»¡ng cho bÃ©</p>
    </div>
</section>

<!-- ===== DANH SÃCH TIN ===== -->
<section class="news-section">
    <div class="container">
        <div id="newsList" class="news-grid"></div>
        
        <div id="loadingNews" class="text-center py-5">
            <div class="loading"></div>
            <p class="mt-3">Äang táº£i tin tá»©c...</p>
        </div>
        
        <div id="emptyNews" class="text-center py-5" style="display: none;">
            <i class="fa fa-newspaper"></i>
            <h3 style="color: #999; margin-top: 20px; font-weight: 700;">ChÆ°a cÃ³ tin tá»©c nÃ o</h3>
            <p class="text-muted" style="font-size: 16px; margin-top: 10px;">HÃ£y quay láº¡i sau Ä‘á»ƒ xem cÃ¡c tin tá»©c má»›i nháº¥t!</p>
        </div>
    </div>
</section>

<!-- ===== FOOTER ===== -->
<footer class="footer">
    <div class="container footer-wrap">
        <div>
            <b>BabyCutie</b>
            <p>ChÃ¡o dinh dÆ°á»¡ng cho bÃ© yÃªu</p>
        </div>
        <div>
            <p>ğŸ“ Hotline: 1900 1234</p>
            <p>ğŸ“§ babycutie@gmail.com</p>
        </div>
    </div>
</footer>

<!-- ===== JS RIÃŠNG ===== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/tin-tuc.js"></script>
<script src="js/search-common.js"></script>
<script>
// Kiá»ƒm tra Ä‘Äƒng nháº­p vÃ  hiá»ƒn thá»‹ thÃ´ng tin
const token = localStorage.getItem("token");
const userInfo = JSON.parse(localStorage.getItem("user_info") || '{}');

if (token && userInfo.hoTen) {
    document.getElementById("userInfo").style.display = "block";
    document.getElementById("loginBtn").style.display = "none";
    document.getElementById("userName").textContent = userInfo.hoTen;
} else {
    document.getElementById("userInfo").style.display = "none";
    document.getElementById("loginBtn").style.display = "block";
}

function logout() {
    localStorage.removeItem("token");
    localStorage.removeItem("user_info");
    if (typeof showToast === 'function') {
        showToast("ÄÃ£ Ä‘Äƒng xuáº¥t thÃ nh cÃ´ng", "info");
    }
    setTimeout(() => {
        location.reload();
    }, 1000);
}

// Cáº­p nháº­t sá»‘ lÆ°á»£ng giá» hÃ ng
function updateCartCount() {
    const token = localStorage.getItem("token");
    const cartCountEl = document.getElementById("cartCount");
    
    if (!token || !cartCountEl) {
        if (cartCountEl) cartCountEl.textContent = "0";
        return;
    }
    
    fetch("http://127.0.0.1:5000/api/gio-hang", {
        headers: {"Authorization": "Bearer " + token}
    })
    .then(res => {
        if (!res.ok) throw new Error('Failed to fetch cart');
        return res.json();
    })
    .then(data => {
        const total = data.reduce((sum, item) => sum + item.soLuong, 0);
        cartCountEl.textContent = total;
        
        if (total > 0) {
            cartCountEl.style.display = "flex";
        } else {
            cartCountEl.style.display = "none";
        }
    })
    .catch(() => {
        if (cartCountEl) cartCountEl.textContent = "0";
    });
}

// Cáº­p nháº­t cart count khi load trang
if (token) {
    updateCartCount();
}
</script>

</body>
</html>
