<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Thanh to√°n | BabyCutie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/gio-hang.css">
    <link rel="stylesheet" href="css/thanh-toan.css">
</head>
<body>

<header class="header">
    <div class="container header-wrap">
        <div class="logo" onclick="location='index.html'">
            <img src="images/logo2.jpg">
            <span>BabyCutie</span>
        </div>
        <div class="d-flex align-items-center gap-3">
            <div class="security-badge">
                <i class="fa fa-shield-alt"></i> B·∫£o m·∫≠t 100%
            </div>
            <a href="gio-hang.html" class="btn-back-cart">
                <i class="fa fa-arrow-left"></i> Quay l·∫°i gi·ªè h√†ng
            </a>
        </div>
    </div>
</header>

<section class="container mt-4">
    <h2 class="checkout-title">üí≥ Thanh to√°n ƒë∆°n h√†ng</h2>

    <div class="row g-4">
        <!-- ===== C·ªòT TR√ÅI: TH√îNG TIN GIAO H√ÄNG ===== -->
        <div class="col-lg-7">
            <!-- PH·∫¶N 1: TH√îNG TIN GIAO H√ÄNG -->
            <div class="checkout-section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h5 class="section-title">Th√¥ng tin giao h√†ng</h5>
                </div>

                <!-- ƒê·ªãa ch·ªâ ƒë√£ l∆∞u -->
                <div class="saved-addresses mb-4">
                    <label class="address-option">
                        <input type="radio" name="addressType" value="saved" checked onchange="handleAddressTypeChange()">
                        <div class="address-card address-card-selected">
                            <div class="address-header">
                                <span class="address-label">Nh√† ri√™ng</span>
                                <span class="address-default">M·∫∂C ƒê·ªäNH</span>
                                <button class="btn-edit-address" onclick="editAddress('home')">
                                    <i class="fa fa-pencil-alt"></i>
                                </button>
                            </div>
                            <div class="address-info" id="savedAddressHome">
                                <strong id="savedNameHome">-</strong> - <span id="savedPhoneHome">-</span><br>
                                <span id="savedAddressHomeText">-</span>
                            </div>
                        </div>
                    </label>
                    <label class="address-option">
                        <input type="radio" name="addressType" value="office" onchange="handleAddressTypeChange()">
                        <div class="address-card">
                            <div class="address-header">
                                <span class="address-label">VƒÉn ph√≤ng</span>
                                <button class="btn-edit-address" onclick="editAddress('office')">
                                    <i class="fa fa-pencil-alt"></i>
                                </button>
                            </div>
                            <div class="address-info" id="savedAddressOffice">
                                <strong id="savedNameOffice">-</strong> - <span id="savedPhoneOffice">-</span><br>
                                <span id="savedAddressOfficeText">-</span>
                            </div>
                        </div>
                    </label>
                    <button class="btn-add-address" onclick="showNewAddressForm()">
                        <i class="fa fa-plus"></i> Th√™m ƒë·ªãa ch·ªâ m·ªõi
                    </button>
                </div>

                <!-- Ho·∫∑c nh·∫≠p th√¥ng tin ng∆∞·ªùi nh·∫≠n m·ªõi -->
                <div class="new-address-form" id="newAddressForm" style="display: none;">
                    <h6 class="form-subtitle">Ho·∫∑c nh·∫≠p th√¥ng tin ng∆∞·ªùi nh·∫≠n m·ªõi</h6>
                    <form id="customerInfoForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">H·ªç v√† t√™n</label>
                                <input 
                                    type="text" 
                                    id="hoTen" 
                                    class="form-control" 
                                    placeholder="V√≠ d·ª•: Nguy·ªÖn V√¢n A"
                                    autocomplete="name">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                                <input 
                                    type="tel" 
                                    id="dienThoai" 
                                    class="form-control" 
                                    placeholder="V√≠ d·ª•: 0912345678"
                                    pattern="[0-9]{10,11}"
                                    autocomplete="tel">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">T·ªânh/Th√†nh ph·ªë</label>
                                <select id="tinhThanh" class="form-select">
                                    <option value="">Ch·ªçn t·ªânh/th√†nh ph·ªë</option>
                                    <option value="da-nang" selected>ƒê√† N·∫µng</option>
                                    <option value="ho-chi-minh">TP. H·ªì Ch√≠ Minh</option>
                                    <option value="ha-noi">H√† N·ªôi</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Qu·∫≠n/Huy·ªán</label>
                                <select id="quanHuyen" class="form-select">
                                    <option value="">Ch·ªçn qu·∫≠n/huy·ªán</option>
                                    <option value="hai-chau" selected>Qu·∫≠n H·∫£i Ch√¢u</option>
                                    <option value="thanh-khe">Qu·∫≠n Thanh Kh√™</option>
                                    <option value="lien-chieu">Qu·∫≠n Li√™n Chi·ªÉu</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ƒê·ªãa ch·ªâ c·ª• th·ªÉ</label>
                            <input 
                                type="text" 
                                id="diaChi" 
                                class="form-control" 
                                placeholder="S·ªë nh√†, t√™n ƒë∆∞·ªùng...">
                        </div>
                    </form>
                </div>

                <!-- Th·ªùi gian nh·∫≠n h√†ng mong mu·ªën -->
                <div class="delivery-time-section mt-4">
                    <h6 class="delivery-time-title">
                        <i class="fa fa-clock"></i> Th·ªùi gian nh·∫≠n h√†ng mong mu·ªën
                    </h6>
                    <div class="delivery-time-options">
                        <button class="time-option active" onclick="selectDeliveryTime('immediate', this)">
                            Ngay l·∫≠p t·ª©c
                        </button>
                        <button class="time-option" onclick="selectDeliveryTime('11-12', this)">
                            11:00-12:00
                        </button>
                        <button class="time-option" onclick="selectDeliveryTime('16-17', this)">
                            16:00-17:00
                        </button>
                        <button class="time-option" onclick="selectDeliveryTime('other', this)">
                            Kh√°c...
                        </button>
                    </div>
                </div>
            </div>

            <!-- PH·∫¶N 2: PH∆Ø∆†NG TH·ª®C THANH TO√ÅN -->
            <div class="checkout-section mt-4">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h5 class="section-title">Ph∆∞∆°ng th·ª©c thanh to√°n</h5>
                </div>
                <div class="payment-methods-list">
                    <label class="payment-method-item payment-method-selected">
                        <input type="radio" name="pttt" value="COD" checked onchange="handlePaymentMethodChange()">
                        <span class="payment-option">
                            <i class="fa fa-money-bill-wave payment-icon-cod"></i>
                            <div>
                                <strong>Thanh to√°n khi nh·∫≠n h√†ng (COD)</strong>
                                <small>Thanh to√°n b·∫±ng ti·ªÅn m·∫∑t tr·ª±c ti·∫øp cho shipper khi nh·∫≠n ƒë∆∞·ª£c ch√°o.</small>
                            </div>
                        </span>
                    </label>
                    <label class="payment-method-item">
                        <input type="radio" name="pttt" value="Chuy·ªÉn kho·∫£n" onchange="handlePaymentMethodChange()">
                        <span class="payment-option">
                            <i class="fa fa-university payment-icon-bank"></i>
                            <div>
                                <strong>Chuy·ªÉn kho·∫£n ng√¢n h√†ng (VietQR)</strong>
                                <small>Qu√©t m√£ QR ƒë·ªÉ thanh to√°n nhanh ch√≥ng, an to√†n v√† ch√≠nh x√°c.</small>
                            </div>
                        </span>
                    </label>
                </div>
            </div>
        </div>

        <!-- ===== C·ªòT PH·∫¢I: T√ìM T·∫ÆT ƒê∆†N H√ÄNG ===== -->
        <div class="col-lg-5">
            <div class="order-summary-checkout">
                <h5 class="section-title">üìã T√≥m t·∫Øt ƒë∆°n h√†ng</h5>
                
                <!-- Danh s√°ch s·∫£n ph·∫©m -->
                <div class="order-items-list" id="orderItemsList">
                    <!-- S·∫Ω ƒë∆∞·ª£c render t·ª´ gi·ªè h√†ng -->
                </div>

                <div class="summary-divider"></div>

                <!-- M√£ gi·∫£m gi√° -->
                <div class="promo-code-section mb-3">
                    <label class="form-label small">M√£ gi·∫£m gi√°</label>
                    <div class="d-flex gap-2">
                        <input 
                            type="text" 
                            id="maKhuyenMai" 
                            class="form-control form-control-sm" 
                            placeholder="Nh·∫≠p m√£ voucher">
                        <button class="btn btn-sm btn-primary" onclick="apDungKhuyenMai()">
                            √Åp d·ª•ng
                        </button>
                    </div>
                    <div id="promoInfo" class="mt-2 small text-success" style="display: none;"></div>
                </div>

                <!-- T·ªïng ph·ª• -->
                <div class="summary-row">
                    <span>T·∫°m t√≠nh</span>
                    <span id="summaryTongPhu">0‚Ç´</span>
                </div>

                <!-- Ph√≠ v·∫≠n chuy·ªÉn -->
                <div class="summary-row">
                    <span>Ph√≠ v·∫≠n chuy·ªÉn</span>
                    <span id="summaryPhiVanChuyen">15.000‚Ç´</span>
                </div>

                <!-- Gi·∫£m gi√° -->
                <div class="summary-row text-success" id="summaryGiamGiaRow" style="display: none;">
                    <span>Gi·∫£m gi√°</span>
                    <span id="summaryGiamGia">-0‚Ç´</span>
                </div>

                <!-- T·ªïng c·ªông -->
                <div class="summary-row total-row">
                    <span class="fw-bold">T·ªïng c·ªông</span>
                    <span class="fw-bold text-primary total-amount" id="summaryTongCong">0‚Ç´</span>
                </div>
                <p class="small text-muted mb-3">(ƒë√£ bao g·ªìm VAT)</p>

                <!-- N√∫t ƒë·∫∑t h√†ng -->
                <button class="btn btn-primary w-100 btn-checkout-large" onclick="datHang()" id="checkoutBtn">
                    Ho√†n t·∫•t ƒë·∫∑t h√†ng <i class="fa fa-arrow-right"></i>
                </button>

                <!-- Th√¥ng b√°o ch·∫•t l∆∞·ª£ng -->
                <div class="quality-notice mt-3">
                    <i class="fa fa-check-circle"></i>
                    <span>ƒê·∫£m b·∫£o dinh d∆∞·ª°ng & v·ªá sinh an to√†n</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- MODAL QR CODE CHUY·ªÇN KHO·∫¢N -->
<div class="modal fade" id="qrPaymentModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #ff6b81, #ff8fa3); color: #fff;">
                <h5 class="modal-title">
                    <i class="fa fa-qrcode"></i> Thanh to√°n chuy·ªÉn kho·∫£n
                </h5>
                <button type="button" class="btn-close btn-close-white" onclick="closeQRModal()"></button>
            </div>
            <div class="modal-body text-center">
                <div class="bank-info mb-4">
                    <h6 class="mb-3">
                        <i class="fa fa-university"></i> Th√¥ng tin t√†i kho·∫£n ng√¢n h√†ng
                    </h6>
                    <div class="bank-details">
                        <p>
                            <strong><i class="fa fa-user"></i> Ch·ªß t√†i kho·∫£n:</strong> 
                            <span id="accountHolder" class="fw-bold" style="color: #ff6b81; font-size: 16px;">PH·∫†M TH√ÄNH ƒê·∫†T</span>
                        </p>
                        <p>
                            <strong><i class="fa fa-phone"></i> S·ªë ƒëi·ªán tho·∫°i:</strong> 
                            <span id="phoneNumber" class="fw-bold" style="color: #ff6b81; font-size: 16px;">0984868340</span>
                            <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyToClipboard('0984868340')">
                                <i class="fa fa-copy"></i> Copy
                            </button>
                        </p>
                        <p>
                            <strong><i class="fa fa-money-bill-wave"></i> S·ªë ti·ªÅn:</strong> 
                            <span id="paymentAmount" class="text-danger fw-bold" style="font-size: 20px;">0ƒë</span>
                        </p>
                        <p>
                            <strong><i class="fa fa-file-text"></i> N·ªôi dung chuy·ªÉn kho·∫£n:</strong> 
                            <span id="paymentContent" class="text-muted fw-bold">DonHang#</span>
                            <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyPaymentContent()">
                                <i class="fa fa-copy"></i> Copy
                            </button>
                        </p>
                    </div>
                </div>
                
                <div class="qr-code-container mb-4">
                    <h6 class="mb-3">
                        <i class="fa fa-qrcode"></i> Qu√©t m√£ QR ƒë·ªÉ thanh to√°n
                    </h6>
                    <div class="qr-image-wrapper">
                        <img id="qrImage" src="images/qr.jpg" alt="QR Code">
                    </div>
                </div>

                <div class="payment-steps">
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <p>Qu√©t m√£ QR</p>
                    </div>
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <p>Nh·∫≠p s·ªë ti·ªÅn</p>
                    </div>
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <p>X√°c nh·∫≠n thanh to√°n</p>
                    </div>
                </div>

                <div class="alert alert-info mt-4">
                    <i class="fa fa-clock"></i> 
                    <strong>L∆∞u √Ω:</strong> Sau khi chuy·ªÉn kho·∫£n, vui l√≤ng ch·ªù 5-10 ph√∫t ƒë·ªÉ h·ªá th·ªëng x√°c nh·∫≠n. 
                    ƒê∆°n h√†ng s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω sau khi nh·∫≠n ƒë∆∞·ª£c thanh to√°n.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeQRModal()">
                    <i class="fa fa-times"></i> ƒê√≥ng
                </button>
                <button type="button" class="btn btn-primary" id="confirmTransferBtn" onclick="confirmBankTransfer(event)">
                    <i class="fa fa-check"></i> ƒê√£ chuy·ªÉn kho·∫£n
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/thanh-toan.js"></script>

</body>
</html>
